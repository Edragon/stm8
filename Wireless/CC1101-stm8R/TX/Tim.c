/**
  ******************************************************************************
  * @file    Tim.c
  * @author  xu
  * @version V1.0.0
  * @date    18-December-2014
  ******************************************************************************/

#include "tim.h"
#include "main.h" 
/*
================================================================================
Function 		: TIMInit()
Description	:	Initinal SPI interface
================================================================================
*/
void TIMInit( void )
{
	
	/*-----------------------*/
	TIM2->PSCR = 1+SYSK/2;				//	1MHz clock
	TIM2->ARRH = 20000 >> 8;		
	TIM2->ARRL = (u8) 20000;			//	20ms
	TIM2->IER |= 1<<0;
	TIM2->CR1 |= 1<<0;
}


/*
================================================================================
Function 		: delay()
Description	:	time delay ( in 20ms )
================================================================================
*/
void delay(u16 nTime)
{	
	u16 t, dt;
	
	t = localTime;
	do{
		dt = localTime - t;
	}while( dt < nTime );
}


/*
================================================================================
Function 		: LedFlash()
Description	:	time delay (in ms)
================================================================================
*/
void LedFlash(u16 nTime)
{	
	GPIOB->ODR |= 1<<0;	
	delay(nTime);
	GPIOB->ODR &= ~(1<<0);
}

/*********************************  END OF FILE  ********************************/
